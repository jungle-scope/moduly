apiVersion: v1
kind: Secret
metadata:
  name: {{ include "moduly.secretName" . }}
  labels:
    {{- include "moduly.labels" . | nindent 4 }}
type: Opaque
data:
  # Database password
  # Example: moduly123
  DB_PASSWORD: {{ .Values.secrets.dbPassword | b64enc | quote }}
  
  # Redis password
  # Example: redis123
  REDIS_PASSWORD: {{ .Values.secrets.redisPassword | b64enc | quote }}
  
  # JWT secret key
  # Example: your-super-secret-jwt-key-change-in-production
  SECRET_KEY: {{ .Values.secrets.secretKey | b64enc | quote }}
  
  # Master encryption key (generate with: openssl rand -base64 32)
  # Example: <GENERATE_WITH_OPENSSL_RAND_BASE64_32>
  {{- if .Values.secrets.masterKey }}
  MASTER_KEY: {{ .Values.secrets.masterKey | b64enc | quote }}
  {{- else }}
  # MASTER_KEY: <REQUIRED_FOR_PRODUCTION>
  {{- end }}
  
  # Encryption key (generate with: openssl rand -base64 32)
  # Example: <GENERATE_WITH_OPENSSL_RAND_BASE64_32>
  {{- if .Values.secrets.encryptionKey }}
  ENCRYPTION_KEY: {{ .Values.secrets.encryptionKey | b64enc | quote }}
  {{- else }}
  # ENCRYPTION_KEY: <REQUIRED_FOR_PRODUCTION>
  {{- end }}
  
  # Sandbox API key
  # Example: Modulycallsandbox306
  SANDBOX_API_KEY: {{ .Values.secrets.sandboxApiKey | b64enc | quote }}
  
  # Google OAuth Client ID (optional)
  # Example: <YOUR_GOOGLE_CLIENT_ID>.apps.googleusercontent.com
  {{- if .Values.secrets.googleClientId }}
  GOOGLE_CLIENT_ID: {{ .Values.secrets.googleClientId | b64enc | quote }}
  {{- else }}
  # GOOGLE_CLIENT_ID: <OPTIONAL_FOR_GOOGLE_LOGIN>
  {{- end }}
  
  # Google OAuth Client Secret (optional)
  # Example: <YOUR_GOOGLE_CLIENT_SECRET>
  {{- if .Values.secrets.googleClientSecret }}
  GOOGLE_CLIENT_SECRET: {{ .Values.secrets.googleClientSecret | b64enc | quote }}
  {{- else }}
  # GOOGLE_CLIENT_SECRET: <OPTIONAL_FOR_GOOGLE_LOGIN>
  {{- end }}
  
  # Llama Cloud API key (optional)
  # Example: <YOUR_LLAMA_CLOUD_API_KEY>
  {{- if .Values.secrets.llamaCloudApiKey }}
  LLAMA_CLOUD_API_KEY: {{ .Values.secrets.llamaCloudApiKey | b64enc | quote }}
  {{- else }}
  # LLAMA_CLOUD_API_KEY: <OPTIONAL_FOR_LLAMA_CLOUD>
  {{- end }}

---
# Note: In production, consider using external secrets management:
# - AWS Secrets Manager with External Secrets Operator
# - HashiCorp Vault
# - Sealed Secrets
# 
# To set secrets via Helm:
#   helm install moduly ./infra/helm/moduly \
#     --set secrets.dbPassword=<YOUR_DB_PASSWORD> \
#     --set secrets.redisPassword=<YOUR_REDIS_PASSWORD> \
#     --set secrets.secretKey=<YOUR_JWT_SECRET>
